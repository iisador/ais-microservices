# Спроектируйте API таск-трекера (типа JIRA)

- Представьте не менее 4 сущностей.
- С действиями

Исходим из следующих ограничений:

- в трекере можно вести несколько проектов;
- в проекте можно создавать задачи;
- задача привязана только к одному проекту;
- задач не привязанных к проекту не существует;
- в проекте можно создавать спринты;
- задача может быть привязана к спринту;
- в трекере идет учет работников и их должностей;
- трекер ведет учет затраченного времени на задачу;
- в задачу могут "списываться" много работников.

Исходя из ограничений можно выделить следующие сущности:

- Проект (project);
- Задача (issue);
- Работник (employee);
- Спринт (sprint);
- Рабочее время\затраченное время на задачу (working time).

Теперь можно построить следующий вариант web api:

| Тип запроса | URI                            | Тело запроса                                                        | Описание                                                      | Идемпотентность |
|-------------|--------------------------------|---------------------------------------------------------------------|---------------------------------------------------------------|-----------------|
| GET         | /projects                      |                                                                     | получить список всех проектов                                 | Да              |
| GET         | /projects/{id}                 |                                                                     | получить описание проекта                                     | Да              |
| PATCH       | /projects/{id}                 |                                                                     | обновить проект                                               | Да              |
| DELETE      | /projects/{id}                 |                                                                     | закрыть проект                                                | Да              |
| GET         | /projects/{id}/issues          |                                                                     | получить список задач проекта                                 | Да              |
| **POST**    | **/projects/{id}/issues**      |                                                                     | **завести новую задачу в проекте**                            | **Нет**         |
| GET         | /projects/{id}/sprints         |                                                                     | получить историю спринтов проекта                             | Да              |
| **POST**    | **/projects/{id}/sprints**     |                                                                     | **завести новый спринт в проекте**                            | **Нет**         |
| GET         | /issues/{id}                   |                                                                     | получить описание задачи                                      | Да              |
| PATCH       | /issues/{id}                   | { "description": "string", "status": "string", "estimate": "date" } | обновить задачу                                               | Да              |
| PATCH       | /issues/{id}/assignee          | { "id": "number" }                                                  | назначить исполнителя для задачи                              | Да              |
| GET         | /issues/{id}/wtime             |                                                                     | получить список затраченного времени для задачи               | Да              |
| **POST**    | **/issues/{id}/wtime**         | **{ "minutes": "number", "report": "string" }**                     | **"списаться" в задачу (минуты, отчет о проделанной работе)** | **Нет**         |
| GET         | /sprints/{id}                  |                                                                     | получить описание спринта                                     | Да              |
| PATCH       | /sprints/{id}                  | { "goal": "string", "ds": "date", "de": "date" }                    | обновить спринт (цель, даты начала и завершения)              | Да              |
| GET         | /sprints/{id}/issues           |                                                                     | получить задачи спринта                                       | Да              |
| PATCH       | /sprints/{id}/issues           | { "id": "number" }                                                  | включить задачу в спринт                                      | Да              |

# С учётом идемпотентности
Добавляем ограничения:
- в один момент времени может существовать только один спринт (создание спринта получается идемпотентным);
- при создании задачи передаётся фиктивный ключ с клиента (исключаем создание дубликатов -> операция идемпотентна);
- при "списывании" в задачу передается фиктивный ключ (исключаем дублирование "списания");

| Тип запроса | URI                    | Тело запроса                                                        | Описание                                                  | Идемпотентность |
|-------------|------------------------|---------------------------------------------------------------------|-----------------------------------------------------------|-----------------|
| GET         | /projects              |                                                                     | получить список всех проектов                             | Да              |
| GET         | /projects/{id}         |                                                                     | получить описание проекта                                 | Да              |
| PATCH       | /projects/{id}         |                                                                     | обновить проект                                           | Да              |
| DELETE      | /projects/{id}         |                                                                     | закрыть проект                                            | Да              |
| GET         | /projects/{id}/issues  |                                                                     | получить список задач проекта                             | Да              |
| POST        | /projects/{id}/issues  | { "id": "uuid" }                                                    | завести новую задачу в проекте                            | Да              |
| GET         | /projects/{id}/sprints |                                                                     | получить историю спринтов проекта                         | Да              |
| POST        | /projects/{id}/sprints |                                                                     | завести новый спринт в проекте                            | Да              |
| GET         | /issues/{id}           |                                                                     | получить описание задачи                                  | Да              |
| PATCH       | /issues/{id}           | { "description": "string", "status": "string", "estimate": "date" } | обновить задачу                                           | Да              |
| PATCH       | /issues/{id}/assignee  | { "id": "number" }                                                  | назначить исполнителя для задачи                          | Да              |
| GET         | /issues/{id}/wtime     |                                                                     | получить список затраченного времени для задачи           | Да              |
| POST        | /issues/{id}/wtime     | { "id": "uuid", "minutes": "number", "report": "string" }           | "списаться" в задачу (минуты, отчет о проделанной работе) | Да              |
| GET         | /sprints/{id}          |                                                                     | получить описание спринта                                 | Да              |
| PATCH       | /sprints/{id}          | { "goal": "string", "ds": "date", "de": "date" }                    | обновить спринт (цель, даты начала и завершения)          | Да              |
| GET         | /sprints/{id}/issues   |                                                                     | получить задачи спринта                                   | Да              |
| PATCH       | /sprints/{id}/issues   | { "id": "number" }                                                  | включить задачу в спринт                                  | Да              |
